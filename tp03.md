# TP 03 - data et output

## Objectif du tp

Créer un docker network via la ligne de commande.
Réutiliser cette resource qui est maintenant existante pour créer des containers docker avec terraform.

## Création du network docker manuellement

On va créer un reseau sur cette plage ip : 172.130.10.0/24 avec une gateway sur 172.130.10.1

```shell
docker network create --subnet 172.130.10.0/24 --ip-range 172.130.10.0/24 --gateway 172.130.10.1 tp_terraform_network
```

## Utilisation du network docker dans terraform via une data

Créer un dossier TP03 dans le dossier tp_terraform.

Dans le dossier TP03, créer 4 fichiers :
- main.tf
- providers.tf
- backend.tf
- outputs.tf

Chercher le provider 'kreuzwerker/docker' sur le registry provider de Terraform

Récupérer les infos du provider et mettre à jour le fichier providers.tf

Identifier la data qui permet de recupérer les infos sur un network docker dans la documentation

Afficher les données suivantes dans un output nommé network_summary, le nom, l'id, le driver et la configuration ipam.

Faire les commandes suivantes :

```shell
terraform init
```

```shell
terraform plan
```

Vous pouvez déjà voir l'output à l'écran lors de cette commande

```shell
terraform apply
```

Vous pouvez voir l'output à l'écran lors de la commande apply

Maintenant utilisons la commande output. c'est très utile pour debugger ou pour echanger des données entre projets terraform

Installer jq (sous git bash : winget install jqlang , sous debian apt install jq, sous alpine apk add jq)

```shell
terraform output
terraform output -json 
terraform output -json | jq
```

Bravo ! Vous venez de créer une data et un output dans terraform. 

Note: il n'y avait aucune resource managée dans ce projet, donc on a rien créé.
Cependant si on regarde le fichier tfstate dans consul, on peut voir que la data a été créée comme une resource

