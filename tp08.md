# TP 08 - Terraform state & terraform import
## Préparation

Créer l'arborescence suivante :
    TP07\module\
                main.tf
                providers.tf  <- copier le fichier de TPO6
                outputs.tf
                backend.tf    <- copier le fichier de TPO6 et change le path du tfstate en TP07
                variables.tf
    TP07\environment\dev
                main.tf
                outputs.tf

## Objectif du tp

L'objectif est de créer un module qui va permettre de créer des docker networks 


## Création du module. 

Se positionner dans le répertoire TP07\module\

Dans fichier variables.tf, créer les 4 variables suivantes sans default value
    network_name
    driver
    subnet
    gateway

Dans le fichier main.tf, créer la resource  "docker_network" appelée "this".

Dans le fichier outputs.tf, créer 2 ouptput : network_id et network_name

Faire un terraform validate pour vérifier que tout est ok !

## Utilisation du module.

Se positionner dans le répertoire TP07\environment\dev

Dans le fichier variables.tf, créer une variable "networks" avec ce contenu :
```hcl 
variable "networks" {
  default = {
    web = { 
      driver  = "bridge"
      subnet  = "172.20.0.0/16"
      gateway = "172.20.0.1"
    }
    api = { 
      driver  = "bridge"
      subnet  = "172.21.0.0/16"
      gateway = "172.21.0.1"
    }
    db = { 
      driver  = "bridge"
      subnet  = "172.22.0.0/16"
      gateway = "172.22.0.1"
    }
  }
}
```

Dans le fichier main.tf, créer l'appel au module précédemment créé :

```hcl 
module "networks" {
 ....
}
```

Dans le fichier outputs.tf, créer un output network_ids qui renvoie une map : (ou la clé est le network_name et la value est le network_id)

Appliquer les changement avec les commandes terraform plan et apply

